import{D as j,V as P,a as Q}from"./DiaryCard-886aD_M2.js";import{d as R}from"./diary-RVIVxxn8.js";import{u as W,r as u,Q as q,X as A,c as n,o as s,w as a,d as o,e as i,aM as E,l as V,F as _,n as h,p as y,f as w,t as c,aS as O,R as v,k as X,h as C,aP as G,ax as H,ay as J,az as K,j as Y}from"./index-BpE4l8E1.js";import{b as D}from"./route-block-B_A1xBdJ.js";import{V as m,a as p}from"./VRow-CssBu1oD.js";import{V as z}from"./VDivider-BcHjN56j.js";import{V as L}from"./VChip-DQVUrN2V.js";import{V as Z}from"./VContainer-Bp0PKZ_j.js";import"./ssrBoot-DLccWrPe.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ee={class:"mb-8"},te={class:"d-flex flex-wrap gap-3"},ae={class:"text-h5 text-primary-darken-1 font-weight-bold"},le={class:"text-body-1"},oe={class:"text-body-1",style:{"white-space":"pre-wrap !important","word-wrap":"break-word !important","word-break":"break-all !important","overflow-wrap":"break-word !important","max-width":"100% !important","line-height":"1.6 !important",display:"block !important",width:"100% !important","box-sizing":"border-box !important"}},re={class:"text-caption text-grey"},se={__name:"diary",setup(ie){const T=W(),b=u([]),g=u(!0),f=u(""),d=u("全部"),r=u({open:!1,diary:null}),B=["全部","快樂","難過","生氣","平靜","問題","職訓局"],I=t=>({全部:"mdi-book-heart",快樂:"mdi-emoticon-happy",難過:"mdi-emoticon-sad",生氣:"mdi-emoticon-angry",平靜:"mdi-emoticon-neutral",問題:"mdi-help-circle",職訓局:"mdi-school"})[t]||"mdi-book-heart",M=t=>{d.value=t},x=q(()=>{let t=b.value;if(d.value&&d.value!=="全部"&&(t=t.filter(e=>e.category===d.value)),f.value){const e=f.value.toLowerCase();t=t.filter(l=>l.description.toLowerCase().includes(e)||l.category.toLowerCase().includes(e))}return t}),N=async()=>{try{g.value=!0;const{data:t}=await R.get();b.value=t.diarys||[]}catch(t){console.error("載入日記失敗:",t)}finally{g.value=!1}},S=t=>{r.value.diary=t,r.value.open=!0},$=()=>{r.value.open=!1,r.value.diary=null},F=t=>t?new Date(t).toLocaleDateString("zh-TW",{year:"numeric",month:"long",day:"numeric"}):"",U=t=>t?new Date(t).toLocaleString("zh-TW"):"";return A(()=>{N()}),(t,e)=>(s(),n(Z,null,{default:a(()=>[o(m,null,{default:a(()=>[o(p,{cols:"12"},{default:a(()=>[e[3]||(e[3]=i("h1",{class:""},"回憶牆",-1)),o(z,{class:"border-opacity-50",color:"orange-darken-2",length:"100",thickness:5})]),_:1,__:[3]})]),_:1}),o(m,{class:"mb-4"},{default:a(()=>[o(p,{cols:"12"},{default:a(()=>[o(E,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=l=>f.value=l),clearable:"","hide-details":"",label:"搜尋回憶"},null,8,["modelValue"])]),_:1})]),_:1}),i("div",ee,[i("div",te,[(s(),V(_,null,h(B,l=>o(L,{key:l,class:"font-weight-medium transition-all hover-lift mr-2",color:d.value===l?"primary":"default",size:"large",variant:d.value===l?"elevated":"outlined",onClick:k=>M(l)},{default:a(()=>[o(w,{class:"mr-2",icon:I(l)},null,8,["icon"]),y(" "+c(l),1)]),_:2},1032,["color","variant","onClick"])),64))])]),g.value?(s(),n(m,{key:0},{default:a(()=>[o(p,{class:"text-center",cols:"12"},{default:a(()=>[o(O,{color:"success",indeterminate:"",size:"64"}),e[4]||(e[4]=i("p",{class:"mt-4 text-body-1"},"載入回憶中...",-1))]),_:1,__:[4]})]),_:1})):x.value.length>0?(s(),n(m,{key:1},{default:a(()=>[(s(!0),V(_,null,h(x.value,l=>(s(),n(p,{key:l._id,cols:"12",lg:"4",md:"6",sm:"6"},{default:a(()=>[o(j,{diary:l,onClick:k=>S(l)},null,8,["diary","onClick"])]),_:2},1024))),128))]),_:1})):(s(),n(m,{key:2},{default:a(()=>[o(p,{class:"text-center",cols:"12"},{default:a(()=>[o(w,{class:"mb-4",color:"grey-lighten-1",size:"64"},{default:a(()=>e[5]||(e[5]=[y("mdi-book-heart-outline")])),_:1,__:[5]}),e[7]||(e[7]=i("h3",{class:"text-h5 text-grey-darken-1 mb-2"},"還沒有回憶",-1)),e[8]||(e[8]=i("p",{class:"text-body-1 text-grey"},"開始記錄您的美好時刻吧！",-1)),X(T).isLogin?(s(),n(C,{key:0,class:"mt-4",color:"success",onClick:e[1]||(e[1]=l=>t.$router.push("/user/diary"))},{default:a(()=>e[6]||(e[6]=[y(" 新增回憶 ")])),_:1,__:[6]})):v("",!0)]),_:1,__:[7,8]})]),_:1})),o(G,{modelValue:r.value.open,"onUpdate:modelValue":e[2]||(e[2]=l=>r.value.open=l),"max-width":"800"},{default:a(()=>[r.value.diary?(s(),n(H,{key:0},{default:a(()=>[o(J,{class:"d-flex align-center justify-space-between"},{default:a(()=>[i("div",null,[i("span",ae,c(r.value.diary.title),1),r.value.diary.date?(s(),n(L,{key:0,class:"ml-2",color:"success",size:"small"},{default:a(()=>[y(c(F(r.value.diary.date)),1)]),_:1})):v("",!0)]),o(C,{icon:"mdi-close",variant:"text",onClick:$})]),_:1}),o(K,null,{default:a(()=>[r.value.diary.image&&r.value.diary.image.length>0?(s(),n(P,{key:0,class:"mb-4",height:"400","hide-delimiter-background":"","show-arrows":"hover"},{default:a(()=>[(s(!0),V(_,null,h(r.value.diary.image,(l,k)=>(s(),n(Q,{key:k},{default:a(()=>[o(Y,{class:"rounded",cover:"",height:"100%",src:l},null,8,["src"])]),_:2},1024))),128))]),_:1})):v("",!0),i("div",le,[e[9]||(e[9]=i("h4",{class:"text-h6 mb-2"},"今日三件好事：",-1)),i("p",oe,c(r.value.diary.description),1)]),o(z,{class:"my-4"}),i("div",re," 建立於："+c(U(r.value.diary.createdAt)),1)]),_:1})]),_:1})):v("",!0)]),_:1},8,["modelValue"])]),_:1}))}};typeof D=="function"&&D(se);export{se as default};
