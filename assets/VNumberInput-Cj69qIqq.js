import{a2 as ie,q as re,s as oe,r as ce,a_ as se,Q as V,U as Y,a9 as de,a0 as $,a1 as ve,ac as F,Y as fe,X as me,C as pe,aM as q,e as b,d as v,F as A,m as be,h as J,ao as Q,a$ as Ne,aJ as ge,b0 as we,an as he,b1 as Pe}from"./index-BpE4l8E1.js";import{V as B}from"./VDivider-BcHjN56j.js";const xe=50,Ve=500;function Ie(n){let{toggleUpDown:M}=n,l=-1,m=-1;ie(c);function I(a){c(),g(a),window.addEventListener("pointerup",c),document.addEventListener("blur",c),l=window.setTimeout(()=>{m=window.setInterval(()=>g(a),xe)},Ve)}function c(){window.clearTimeout(l),window.clearInterval(m),window.removeEventListener("pointerup",c),document.removeEventListener("blur",c)}function g(a){M(a==="up")}return{holdStart:I,holdStop:c}}const De=oe({controlVariant:{type:String,default:"default"},inset:Boolean,hideInput:Boolean,modelValue:{type:Number,default:null},min:{type:Number,default:Number.MIN_SAFE_INTEGER},max:{type:Number,default:Number.MAX_SAFE_INTEGER},step:{type:Number,default:1},precision:{type:Number,default:0},...ge(we(),["modelValue","validationValue"])},"VNumberInput"),Ee=re()({name:"VNumberInput",props:{...De()},emits:{"update:focused":n=>!0,"update:modelValue":n=>!0},setup(n,M){let{slots:l}=M;const m=ce(),{holdStart:I,holdStop:c}=Ie({toggleUpDown:U}),g=se(n),a=V(()=>g.isDisabled.value||g.isReadonly.value),D=Y(n.focused);function w(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.precision;const r=t==null?String(e):e.toFixed(t);return D.value?Number(r).toString():r}const u=de(n,"modelValue",null,e=>e??null,e=>e==null?e??null:$(Number(e),n.min,n.max)),h=Y(null);ve(()=>{D.value&&!a.value||(u.value==null?h.value=null:isNaN(u.value)||(h.value=w(u.value)))});const o=V({get:()=>h.value,set(e){e===null||e===""?(u.value=null,h.value=null):!isNaN(Number(e))&&Number(e)<=n.max&&Number(e)>=n.min&&(u.value=Number(e),h.value=e)}}),R=V(()=>a.value?!1:(u.value??0)+n.step<=n.max),L=V(()=>a.value?!1:(u.value??0)-n.step>=n.min),i=V(()=>n.hideInput?"stacked":n.controlVariant),z=F(()=>i.value==="split"?"$plus":"$collapse"),H=F(()=>i.value==="split"?"$minus":"$expand"),C=F(()=>i.value==="split"?"default":"small"),y=F(()=>i.value==="stacked"?"auto":"100%"),Z={props:{onClick:E,onPointerup:f,onPointerdown:O,onPointercancel:f}},j={props:{onClick:E,onPointerup:f,onPointerdown:G,onPointercancel:f}};fe(()=>n.precision,()=>ne()),me(()=>{_()});function K(e){if(e==null)return 0;const t=e.toString(),r=t.indexOf(".");return~r?t.length-r:0}function U(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(a.value)return;if(u.value==null){o.value=w($(0,n.min,n.max));return}let t=Math.max(K(u.value),K(n.step));n.precision!=null&&(t=Math.max(t,n.precision)),e?R.value&&(o.value=w(u.value+n.step,t)):L.value&&(o.value=w(u.value-n.step,t))}function W(e){var k;if(!e.data)return;const t=e.target,{value:r,selectionStart:S,selectionEnd:T}=t??{},p=r?r.slice(0,S)+e.data+r.slice(T):e.data,N=Pe(p,n.precision);/^-?(\d+(\.\d*)?|(\.\d+)|\d*|\.)$/.test(p)||(e.preventDefault(),t.value=N),n.precision!=null&&(((k=p.split(".")[1])==null?void 0:k.length)>n.precision&&(e.preventDefault(),t.value=N),n.precision===0&&p.includes(".")&&(e.preventDefault(),t.value=N))}async function ee(e){["Enter","ArrowLeft","ArrowRight","Backspace","Delete","Tab"].includes(e.key)||e.ctrlKey||["ArrowDown","ArrowUp"].includes(e.key)&&(e.preventDefault(),_(),await he(),e.key==="ArrowDown"?U(!1):U())}function E(e){e.stopPropagation()}function f(e){const t=e.currentTarget;t==null||t.releasePointerCapture(e.pointerId),e.preventDefault(),c()}function O(e){const t=e.currentTarget;t==null||t.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),I("up")}function G(e){const t=e.currentTarget;t==null||t.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),I("down")}function _(){if(a.value||!m.value)return;const e=m.value.value;e&&!isNaN(Number(e))?o.value=w($(Number(e),n.min,n.max)):o.value=null}function ne(){if(!a.value){if(u.value===null||isNaN(u.value)){o.value=null;return}o.value=n.precision==null?String(u.value):u.value.toFixed(n.precision)}}function te(){if(!a.value){if(u.value===null||isNaN(u.value)){o.value=null;return}o.value=u.value.toString()}}function ue(){te()}function le(){_()}return pe(()=>{const{modelValue:e,...t}=q.filterProps(n);function r(){return l.increment?v(Q,{key:"increment-defaults",defaults:{VBtn:{disabled:!R.value,flat:!0,height:y.value,size:C.value,icon:z.value}}},{default:()=>[l.increment(Z)]}):v(J,{"aria-hidden":"true","data-testid":"increment",disabled:!R.value,flat:!0,height:y.value,icon:z.value,key:"increment-btn",onClick:E,onPointerdown:O,onPointerup:f,onPointercancel:f,size:C.value,tabindex:"-1"},null)}function S(){return l.decrement?v(Q,{key:"decrement-defaults",defaults:{VBtn:{disabled:!L.value,flat:!0,height:y.value,size:C.value,icon:H.value}}},{default:()=>[l.decrement(j)]}):v(J,{"aria-hidden":"true","data-testid":"decrement",disabled:!L.value,flat:!0,height:y.value,icon:H.value,key:"decrement-btn",onClick:E,onPointerdown:G,onPointerup:f,onPointercancel:f,size:C.value,tabindex:"-1"},null)}function T(){return b("div",{class:"v-number-input__control"},[S(),v(B,{vertical:i.value!=="stacked"},null),r()])}function p(){return!n.hideInput&&!n.inset?v(B,{vertical:!0},null):void 0}const N=i.value==="split"?b("div",{class:"v-number-input__control"},[v(B,{vertical:!0},null),r()]):n.reverse||i.value==="hidden"?void 0:b(A,null,[p(),T()]),k=l["append-inner"]||N,X=i.value==="split"?b("div",{class:"v-number-input__control"},[S(),v(B,{vertical:!0},null)]):n.reverse&&i.value!=="hidden"?b(A,null,[T(),p()]):void 0,ae=l["prepend-inner"]||X;return v(q,be({ref:m},t,{modelValue:o.value,"onUpdate:modelValue":s=>o.value=s,focused:D.value,"onUpdate:focused":s=>D.value=s,validationValue:u.value,onBeforeinput:W,onFocus:ue,onBlur:le,onKeydown:ee,class:["v-number-input",{"v-number-input--default":i.value==="default","v-number-input--hide-input":n.hideInput,"v-number-input--inset":n.inset,"v-number-input--reverse":n.reverse,"v-number-input--split":i.value==="split","v-number-input--stacked":i.value==="stacked"},n.class],style:n.style,inputmode:"decimal"}),{...l,"append-inner":k?function(){var x;for(var s=arguments.length,P=new Array(s),d=0;d<s;d++)P[d]=arguments[d];return b(A,null,[(x=l["append-inner"])==null?void 0:x.call(l,...P),N])}:void 0,"prepend-inner":ae?function(){var x;for(var s=arguments.length,P=new Array(s),d=0;d<s;d++)P[d]=arguments[d];return b(A,null,[X,(x=l["prepend-inner"])==null?void 0:x.call(l,...P)])}:void 0})}),Ne({},m)}});export{Ee as V};
