import{aT as N,r as h,Q as I,Y as G,X as Q,aU as J,aV as Z,c as f,o as i,w as l,d as s,e as u,R as w,l as x,aN as ee,aW as te,h as A,p as m,F as L,n as M,f as W,t as _,aF as ae,N as se,ax as le,ay as ne,az as re,aP as oe,aO as ie,g as ue}from"./index-8XkL9mke.js";import{b as $}from"./route-block-B_A1xBdJ.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as g,V as y}from"./VRow-BxM1Nn8a.js";import{V as de}from"./VContainer-3X4AzbHd.js";import{V as C}from"./VDivider-DhumEhaV.js";import{V as z}from"./VChip-Ci4F4dQL.js";import{V as me}from"./VAlert-CR8tNO2w.js";import{V as ve}from"./VPagination-BwrHQKQj.js";import{V as fe}from"./VFooter-CntQt0nl.js";class pe{constructor(){this.cache=new Map,this.defaultTTL=2*24*60*60*1e3}set(o,n,r=this.defaultTTL){const c=Date.now();this.cache.set(o,{data:n,timestamp:c,ttl:r})}get(o){const n=this.cache.get(o);return n?Date.now()-n.timestamp>n.ttl?(this.cache.delete(o),null):n.data:null}has(o){const n=this.cache.get(o);return n?Date.now()-n.timestamp>n.ttl?(this.cache.delete(o),!1):!0:!1}delete(o){this.cache.delete(o)}clear(){this.cache.clear()}getStats(){return{size:this.cache.size,keys:Array.from(this.cache.keys())}}}const V=new pe,K={getAllThisYear(){return N.api.get("/hpanews")},searchThisYear(k){const o={};return k&&(o.keyword=k),N.api.get("/hpanews/search",{params:o})},getLatestThisYear(){return N.api.get("/hpanews/latest")}},he={class:"mb-6"},ge={class:"d-flex flex-wrap gap-3"},_e=["innerHTML"],ye={class:"d-flex justify-space-between align-center mt-2"},we={key:4,class:"d-flex justify-center mt-10"},Ve={class:"d-flex ga-3"},P=12,j=Object.assign({name:"Hpanews"},{__name:"hpanews",setup(k){const o=["mdi-github","mdi-google","mdi-linkedin","mdi-instagram"],n=h([]),r=h(!1),c=h(""),d=h(""),Y=h(null),T=h("全部"),p=h(1),F=I(()=>Math.ceil(n.value.length/P)),S=I(()=>{const t=(p.value-1)*P,e=t+P;return n.value.slice(t,e)}),b={LATEST_NEWS:"hpanews_latest",SEARCH_PREFIX:"hpanews_search_"},O=["全部","營養","健康","癌症","糖尿病","高血壓","肥胖","運動","飲食","兒童","戒菸","補助","檢查"],U=t=>({全部:"mdi-newspaper-variant",營養:"mdi-food-apple",健康:"mdi-heart",癌症:"mdi-hospital",糖尿病:"mdi-spoon-sugar",高血壓:"mdi-heart-pulse",肥胖:"mdi-weight",運動:"mdi-run",飲食:"mdi-food-fork-drink",兒童:"mdi-baby-face",戒菸:"mdi-smoking-off",補助:"mdi-cash",檢查:"mdi-stethoscope"})[t]||"mdi-newspaper-variant",E=async()=>{r.value=!0,c.value="",p.value=1;try{const t=`${b.SEARCH_PREFIX}${d.value}`,e=V.get(t);if(d.value&&e){n.value=e,r.value=!1;return}const a=(await K.searchThisYear(d.value)).data.data||[];n.value=a,d.value&&V.set(t,a)}catch(t){console.error("搜尋新聞失敗:",t),c.value="載入新聞時發生錯誤，請稍後再試",n.value=[]}finally{r.value=!1}},X=async t=>{T.value=t,p.value=1,t==="全部"?(d.value="",Y.value=null,await D()):(d.value=t,Y.value=null,await E())},R=t=>{if(!t)return"";try{return new Date(t).toLocaleDateString("zh-TW")}catch{return t}},q=(t,e)=>{if(!t)return"";const v=t.replace(/<[^>]*>/g,"");return v.length<=e?t:v.slice(0,Math.max(0,e))+"..."},B=t=>{t&&window.open(t,"_blank")},D=async()=>{r.value=!0,c.value="",p.value=1;try{const t=V.get(b.LATEST_NEWS);if(t){n.value=t,r.value=!1;return}const v=(await K.getLatestThisYear()).data.data||[];n.value=v,V.set(b.LATEST_NEWS,v)}catch(t){console.error("載入最新新聞失敗:",t),c.value="載入最新新聞時發生錯誤，請稍後再試",n.value=[]}finally{r.value=!1}};return G(d,()=>{p.value=1}),Q(()=>{D()}),J(()=>{if(n.value.length===0){const t=V.get(b.LATEST_NEWS);t?n.value=t:D()}}),(t,e)=>{const v=Z("lazy");return i(),f(y,null,{default:l(()=>[s(g,{cols:"12"},{default:l(()=>[s(de,null,{default:l(()=>[s(y,null,{default:l(()=>[s(g,{cols:"12"},{default:l(()=>[e[10]||(e[10]=u("h1",{class:"mb-2"},"最新健康新聞",-1)),s(C,{class:"mb-5 border-opacity-50",color:"orange-darken-2",length:"150",thickness:5}),s(y,null,{default:l(()=>[s(g,{cols:"12",md:"10"},{default:l(()=>[s(ee,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=a=>d.value=a),clearable:"",label:"搜尋關鍵字",placeholder:"例如：營養、健康、癌症、兒童",onKeyup:te(E,["enter"])},null,8,["modelValue"])]),_:1}),s(g,{class:"pa-4",cols:"12",md:"2"},{default:l(()=>[s(A,{block:"",class:"text-body-1 font-weight-bold",color:"primary",height:"50",loading:r.value,onClick:E},{default:l(()=>e[4]||(e[4]=[m(" 搜尋 ")])),_:1,__:[4]},8,["loading"])]),_:1})]),_:1}),u("div",he,[u("div",ge,[(i(),x(L,null,M(O,a=>s(z,{key:a,class:"font-weight-medium transition-all hover-lift mt-2 mr-2",color:T.value===a?"primary":"default",loading:r.value&&T.value===a,size:"large",variant:T.value===a?"elevated":"outlined",onClick:H=>X(a)},{default:l(()=>[s(W,{class:"mr-2",icon:U(a)},null,8,["icon"]),m(" "+_(a),1)]),_:2},1032,["color","loading","variant","onClick"])),64))])]),r.value?(i(),f(y,{key:0},{default:l(()=>[s(g,{class:"text-center",cols:"12"},{default:l(()=>[s(ae,{color:"primary",indeterminate:"",size:"64"}),e[5]||(e[5]=u("p",{class:"mt-4"},"正在載入健康新聞...",-1))]),_:1,__:[5]})]),_:1})):w("",!0),c.value?(i(),f(me,{key:1,closable:"",type:"error","onClick:close":e[1]||(e[1]=a=>c.value="")},{default:l(()=>[m(_(c.value),1)]),_:1})):w("",!0),S.value.length>0?(i(),f(y,{key:2},{default:l(()=>[(i(!0),x(L,null,M(S.value,a=>(i(),f(g,{key:a.標題,cols:"12",lg:"4",md:"6"},{default:l(()=>[se((i(),f(le,{class:"h-100 mb-3",elevation:"2",hover:"",style:{cursor:"pointer"},onClick:H=>B(a.連結網址)},{default:l(()=>[s(ne,{class:"text-h6"},{default:l(()=>[m(_(a.標題),1)]),_:2},1024),s(re,{class:"pb-2"},{default:l(()=>[u("div",{class:"text-body-2 news-content",innerHTML:q(a.內容,130)},null,8,_e),u("div",ye,[s(z,{color:"info",size:"small",variant:"outlined"},{default:l(()=>[m(_(R(a.發布日期)),1)]),_:2},1024),a.修改日期&&a.修改日期!==a.發布日期?(i(),f(z,{key:0,color:"warning",size:"small",variant:"outlined"},{default:l(()=>[m(" 更新: "+_(R(a.修改日期)),1)]),_:2},1024)):w("",!0)])]),_:2},1024),s(oe,{onClick:e[2]||(e[2]=ie(()=>{},["stop"]))},{default:l(()=>[s(ue),s(A,{class:"mt-3 mr-2",color:"primary",variant:"elevated",onClick:H=>B(a.連結網址)},{default:l(()=>e[6]||(e[6]=[m(" 閱讀更多 ")])),_:2,__:[6]},1032,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"])),[[v]])]),_:2},1024))),128))]),_:1})):!r.value&&S.value.length===0?(i(),f(y,{key:3},{default:l(()=>[s(g,{class:"text-center",cols:"12"},{default:l(()=>[s(W,{color:"grey",size:"64"},{default:l(()=>e[7]||(e[7]=[m("mdi-newspaper-variant-outline")])),_:1,__:[7]}),e[8]||(e[8]=u("p",{class:"text-h6 mt-4"},"沒有找到相關的健康新聞",-1)),e[9]||(e[9]=u("p",{class:"text-body-2 text-grey"},"請嘗試其他關鍵字或日期範圍",-1))]),_:1,__:[8,9]})]),_:1})):w("",!0),F.value>1&&!r.value?(i(),x("div",we,[s(ve,{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=a=>p.value=a),length:F.value,rounded:"circle","total-visible":7},null,8,["modelValue","length"])])):w("",!0)]),_:1,__:[10]})]),_:1})]),_:1}),s(fe,{class:"text-center d-flex flex-column ga-2 mt-7",color:"indigo-lighten-1"},{default:l(()=>[u("div",Ve,[(i(),x(L,null,M(o,a=>s(A,{key:a,density:"comfortable",icon:a,variant:"text"},null,8,["icon"])),64))]),s(C,{class:"my-2",thickness:"2",width:"50"}),e[12]||(e[12]=u("div",{class:"text-caption font-weight-regular opacity-60"}," Phasellus feugiat arcu sapien, et iaculis ipsum elementum sit amet. Mauris cursus commodo interdum. Praesent ut risus eget metus luctus accumsan id ultrices nunc. Sed at orci sed massa consectetur dignissim a sit amet dui. Duis commodo vitae velit et faucibus. Morbi vehicula lacinia malesuada. Nulla placerat augue vel ipsum ultrices, cursus iaculis dui sollicitudin. Vestibulum eu ipsum vel diam elementum tempor vel ut orci. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. ",-1)),s(C),u("div",null,[s(C,{class:"pt-5"}),m(" "+_(new Date().getFullYear())+" — ",1),e[11]||(e[11]=u("strong",null," © Yuna 版權所有",-1))])]),_:1,__:[12]})]),_:1})]),_:1})}}});typeof $=="function"&&$(j);const Le=ce(j,[["__scopeId","data-v-2cb46125"]]);export{Le as default};
