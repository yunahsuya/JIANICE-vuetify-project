import{u as F,r as f,Q as M,X as O,c as _,o as x,w as a,d as t,ax as T,ay as j,p as i,f as b,aO as D,aN as c,R,e as k,t as v,h as V,aS as A,S as C}from"./index-8XkL9mke.js";import{b as S}from"./route-block-B_A1xBdJ.js";import{V as g,a as s}from"./VRow-BxM1Nn8a.js";import{V as P}from"./VForm-GbORafpw.js";import{V as Q}from"./VAlert-CR8tNO2w.js";import{V as X}from"./VChip-Ci4F4dQL.js";import{a as U}from"./VSelect-vvEmrbvY.js";import{V as $}from"./VContainer-3X4AzbHd.js";import"./VList-BZs7Wlsb.js";import"./ssrBoot-H2_3cXLE.js";import"./VDivider-DhumEhaV.js";import"./VMenu-1u2F--IG.js";const E={class:"d-flex align-center"},G={__name:"info",setup(H){F();const h=f(null),d=f(!1),r=f({account:"",email:"",height:null,weight:null,disease:[],state:[]}),q=[{title:"高血壓",value:"高血壓"},{title:"糖尿病",value:"糖尿病"},{title:"心臟病",value:"心臟病"},{title:"無特殊疾病",value:"無特殊疾病"}],B=[{title:"健身",value:"健身"},{title:"減重",value:"減重"},{title:"增重",value:"增重"},{title:"維持健康",value:"維持健康"}],u={required:l=>!!l||"此欄位為必填",email:l=>/.+@.+\..+/.test(l)||"請輸入有效的電子郵件",height:l=>l>=100&&l<=250||"身高應在 100-250 公分之間",weight:l=>l>=30&&l<=200||"體重應在 30-200 公斤之間"},m=M(()=>{if(!r.value.height||!r.value.weight)return null;const l=r.value.height/100;return r.value.weight/(l*l)}),I=l=>l<18.5?"體重過輕":l<24?"正常體重":l<27?"體重過重":l<30?"輕度肥胖":"重度肥胖",w=l=>l<18.5?"blue":l<24?"green":l<27?"orange":"red",n=f({show:!1,text:"",color:"success"}),y=async()=>{try{d.value=!0;const e=(await C.profile()).data.user;r.value={account:e.account||"",email:e.email||"",height:e.height||null,weight:e.weight||null,disease:e.disease||[],state:e.state||[]}}catch(l){console.error("載入使用者資訊失敗:",l),p("載入使用者資訊失敗","error")}finally{d.value=!1}},N=async()=>{const{valid:l}=await h.value.validate();if(l)try{d.value=!0,await C.updateProfile(r.value),p("資訊儲存成功！","success")}catch(e){console.error("儲存失敗:",e),p("儲存失敗，請稍後再試","error")}finally{d.value=!1}},z=()=>{y()},p=(l,e="success")=>{n.value={show:!0,text:l,color:e}};return O(()=>{y()}),(l,e)=>(x(),_($,null,{default:a(()=>[t(g,{justify:"center"},{default:a(()=>[t(s,{cols:"12",lg:"6",md:"8"},{default:a(()=>[t(T,{class:"pa-6"},{default:a(()=>[t(j,{class:"text-h4 mb-4 text-center"},{default:a(()=>[t(b,{class:"mr-2",size:"large"},{default:a(()=>e[8]||(e[8]=[i("mdi-account-circle")])),_:1,__:[8]}),e[9]||(e[9]=i(" 個人基本資訊 "))]),_:1,__:[9]}),t(P,{ref_key:"form",ref:h,onSubmit:D(N,["prevent"])},{default:a(()=>[t(g,null,{default:a(()=>[t(s,{cols:"12",md:"6"},{default:a(()=>[t(c,{modelValue:r.value.height,"onUpdate:modelValue":e[0]||(e[0]=o=>r.value.height=o),label:"身高 (公分)",max:"250",min:"100","prepend-inner-icon":"mdi-human-male-height",rules:[u.required,u.height],suffix:"cm",type:"number",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(s,{cols:"12",md:"6"},{default:a(()=>[t(c,{modelValue:r.value.weight,"onUpdate:modelValue":e[1]||(e[1]=o=>r.value.weight=o),label:"體重 (公斤)",max:"200",min:"30","prepend-inner-icon":"mdi-weight",rules:[u.required,u.weight],suffix:"kg",type:"number",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(s,{cols:"12"},{default:a(()=>[m.value?(x(),_(Q,{key:0,class:"mb-4",color:w(m.value),variant:"tonal"},{default:a(()=>[k("div",E,[t(b,{class:"mr-2"},{default:a(()=>e[10]||(e[10]=[i("mdi-calculator")])),_:1,__:[10]}),k("strong",null,"您的 BMI："+v(m.value.toFixed(1)),1),t(X,{class:"ml-2",color:w(m.value),size:"small"},{default:a(()=>[i(v(I(m.value)),1)]),_:1},8,["color"])])]),_:1},8,["color"])):R("",!0)]),_:1}),t(s,{cols:"12"},{default:a(()=>[t(U,{modelValue:r.value.disease,"onUpdate:modelValue":e[2]||(e[2]=o=>r.value.disease=o),chips:"",clearable:"",items:q,label:"疾病狀況",multiple:"","prepend-inner-icon":"mdi-heart-pulse",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(s,{cols:"12"},{default:a(()=>[t(U,{modelValue:r.value.state,"onUpdate:modelValue":e[3]||(e[3]=o=>r.value.state=o),chips:"",items:B,label:"健身目標",multiple:"","prepend-inner-icon":"mdi-dumbbell",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(s,{cols:"12"},{default:a(()=>[t(c,{modelValue:r.value.email,"onUpdate:modelValue":e[4]||(e[4]=o=>r.value.email=o),label:"電子郵件","prepend-inner-icon":"mdi-email",readonly:"",rules:[u.required,u.email],type:"email",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(s,{cols:"12"},{default:a(()=>[t(c,{modelValue:r.value.account,"onUpdate:modelValue":e[5]||(e[5]=o=>r.value.account=o),label:"帳號","prepend-inner-icon":"mdi-account",readonly:"",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(g,{class:"mt-4"},{default:a(()=>[t(s,{class:"d-flex justify-center gap-4",cols:"12"},{default:a(()=>[t(V,{class:"mr-5",color:"secondary","prepend-icon":"mdi-refresh",size:"large",variant:"outlined",onClick:z},{default:a(()=>e[11]||(e[11]=[i(" 重置 ")])),_:1,__:[11]}),t(V,{color:"primary",loading:d.value,"prepend-icon":"mdi-content-save",size:"large",type:"submit"},{default:a(()=>e[12]||(e[12]=[i(" 儲存資訊 ")])),_:1,__:[12]},8,["loading"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1}),t(A,{modelValue:n.value.show,"onUpdate:modelValue":e[7]||(e[7]=o=>n.value.show=o),color:n.value.color,timeout:3e3},{actions:a(()=>[t(V,{color:"white",variant:"text",onClick:e[6]||(e[6]=o=>n.value.show=!1)},{default:a(()=>e[13]||(e[13]=[i(" 關閉 ")])),_:1,__:[13]})]),default:a(()=>[i(v(n.value.text)+" ",1)]),_:1},8,["modelValue","color"])]),_:1}))}};typeof S=="function"&&S(G);export{G as default};
